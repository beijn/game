name: Build Game Container
on:
  push:
    branches: [main]
env: 
  image: ghcr.io/beijn/game-builder:wasm

jobs:
  build-game-container:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - run: |
        echo "${{ secrets.GITHUB_TOKEN }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin
        #docker pull $image || :
        docker build . -f ./Dockerfile -t $image --cache-from $image --target builder-wasm # --rm=false
        docker push $image

